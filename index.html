<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>MISSION: RESCUE BI-A ROBOT ü§ñ</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --main: #00d2ff; --accent: #9d50bb; --danger: #ff4b2b; --success: #45a247; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f2027; background: linear-gradient(to right, #2c5364, #203a43, #0f2027); color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        #game-box { background: rgba(0, 0, 0, 0.9); border: 2px solid var(--main); width: 90%; max-width: 700px; padding: 30px; border-radius: 20px; box-shadow: 0 0 30px var(--main); text-align: center; }
        
        input { padding: 12px; border-radius: 8px; border: 1px solid var(--main); background: rgba(255,255,255,0.1); color: white; width: 80%; margin-bottom: 15px; font-size: 16px; }
        .ai-core { width: 70px; height: 70px; background: var(--main); border-radius: 50%; margin: 0 auto 15px; box-shadow: 0 0 20px var(--main); display: flex; align-items: center; justify-content: center; font-size: 35px; }
        .status-bar { width: 100%; height: 12px; background: #333; border-radius: 10px; margin: 15px 0; overflow: hidden; border: 1px solid #555; }
        #progress { width: 0%; height: 100%; background: linear-gradient(to right, #00d2ff, #9d50bb); transition: width 0.5s; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { background: rgba(255,255,255,0.1); border: 1px solid var(--main); color: white; padding: 12px; border-radius: 10px; cursor: pointer; transition: 0.3s; }
        .btn:hover:not(:disabled) { background: var(--main); color: black; font-weight: bold; }
        .glitch { animation: shake 0.3s infinite; border-color: var(--danger) !important; color: var(--danger) !important; }
        @keyframes shake { 0% {transform: translate(1px, 1px);} 20% {transform: translate(-2px, 0px);} 100% {transform: translate(0, 0);} }
        
        #next-btn { display: none; margin-top: 20px; padding: 10px 30px; background: var(--success); color: white; border: none; border-radius: 50px; cursor: pointer; font-size: 16px; }
        #play-screen, #final-screen { display: none; }
    </style>
</head>
<body>

<div id="game-box">
    <div id="login-screen">
        <h1 style="color: var(--main);">ü§ñ NHI·ªÜM V·ª§ GI·∫¢I C·ª®U</h1>
        <p>Nh·∫≠p th√¥ng tin ƒë·ªÉ b·∫Øt ƒë·∫ßu gi·∫£i c·ª©u Robot Bi-A</p>
        <input type="text" id="p-name" placeholder="H·ªç v√† T√™n h·ªçc sinh" required><br>
        <input type="text" id="p-class" placeholder="L·ªõp (V√≠ d·ª•: 7A1)" required><br>
        <button class="btn" style="width: 85%; background: var(--main); color: black; font-weight: bold;" onclick="checkLogin()">V√ÄO V·ªä TR√ç CHI·∫æN ƒê·∫§U</button>
    </div>

    <div id="play-screen">
        <div style="font-size: 20px; color: #ff9f43; margin-bottom: 10px;">ƒêI·ªÇM: <span id="points">0</span></div>
        <div class="ai-core" id="ai-icon">ü§ñ</div>
        <div class="status-bar"><div id="progress"></div></div>
        <h2 id="q-text" style="font-size: 18px; min-height: 50px;"></h2>
        <div class="grid" id="ans-grid"></div>
        <button id="next-btn" onclick="nextStep()">X√ÅC NH·∫¨N ‚ûî</button>
    </div>

    <div id="final-screen">
        <h1 id="final-title">H·ªÜ TH·ªêNG ƒê√É KH√îI PH·ª§C!</h1>
        <p id="final-desc"></p>
        <h2 id="final-score" style="color: var(--main);"></h2>
        <p id="save-status" style="color: #aaa; font-style: italic;">ƒêang l∆∞u k·∫øt qu·∫£...</p>
        <button class="btn" onclick="location.reload()">CH∆†I L·∫†I</button>
    </div>
</div>

<script>
    // --- PH·∫¶N C·∫§U H√åNH GOOGLE FORM C·ª¶A B·∫†N ---
    const CONFIG_FORM = {
        formAction: "https://docs.google.com/forms/d/e/1FAIpQLSda4kGylYwxOjVrfn9VRXVgHqtjg2QhH3KvXYrZKSCrjB3zjQ/viewform?usp=dialog", // THAY LINK formResponse T·∫†I ƒê√ÇY
        entryName: "entry.2038111055",  // THAY ID √î H·ªå T√äN
        entryClass: "entry.1611801759", // THAY ID √î L·ªöP
        //<input type="hidden" name="entry.1611801759" value="">
        entryScore: "entry.1076541849"  // THAY ID √î ƒêI·ªÇM
        //<input type="hidden" name="entry.1076541849" value="">
    };

    const db = [
        {q: "ƒê·ªÉ AI nh·∫≠n di·ªán 'M·∫∑t c∆∞·ªùi' ch√≠nh x√°c, b·∫°n kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ l·∫´n 'M·∫∑t bu·ªìn' v√†o. ƒê√¢y l√† ch·ªØ ƒê n√†o?", a: ["ƒê√∫ng (Accuracy)", "ƒê·ªß", "ƒêa d·∫°ng", "ƒê·∫πp"], c: 0},
        {q: "N·∫øu nh√£n 'Vui' c√≥ 100 ·∫£nh, nh√£n 'Bu·ªìn' ch·ªâ c√≥ 2 ·∫£nh, m√°y s·∫Ω b·ªã l·ªói g√¨?", a: ["H·∫øt pin", "M·∫•t m·∫°ng", "L·ªách (Bias)", "H·ªèng cam"], c: 2},
        {q: "C√¢u n√≥i 'Garbage In - Garbage Out' c√≥ nghƒ©a l√† g√¨?", a: ["AI t·ª± d·ªçn r√°c", "D·ªØ li·ªáu r√°c ra k·∫øt qu·∫£ r√°c", "AI r·∫•t th√¥ng minh", "M√°y t√≠nh c·∫ßn v·ªá sinh"], c: 1},
        {q: "ƒê·ªÉ AI nh·∫≠n di·ªán ƒë∆∞·ª£c c·∫£ khi ƒëeo kh·∫©u trang, ta c·∫ßn th√™m d·ªØ li·ªáu theo ti√™u chu·∫©n n√†o?", a: ["ƒê√∫ng", "ƒê·ªß", "ƒêa d·∫°ng (Diversity)", "ƒê·∫Øt"], c: 2},
        {q: "M·ªói nh√£n c·∫£m x√∫c c·∫ßn t·ªëi thi·ªÉu bao nhi√™u ·∫£nh ƒë·ªÉ m√°y b·∫Øt ƒë·∫ßu h·ªçc ƒë∆∞·ª£c?", a: ["1 t·∫•m", "5 t·∫•m", "15-20 t·∫•m", "1 tri·ªáu t·∫•m"], c: 2},
        {q: "Ch·ª•p ·∫£nh ·ªü nhi·ªÅu g√≥c nghi√™ng, th·∫≥ng v√† √°nh s√°ng kh√°c nhau l√† ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh g√¨?", a: ["ƒêa d·∫°ng", "Ti·∫øt ki·ªám", "L√†m ƒë·∫πp", "Ch√≠nh x√°c"], c: 0},
        {q: "Th·ª≠ th√°ch Bias (m·ªùi ng∆∞·ªùi l·∫° v√†o qu√©t th·ª≠) d√πng ƒë·ªÉ ki·ªÉm tra ƒëi·ªÅu g√¨?", a: ["ƒê·ªô b·ªÅn m√°y", "T√≠nh ƒëa d·∫°ng c·ªßa d·ªØ li·ªáu", "T·ªëc ƒë·ªô m·∫°ng", "K·ªπ nƒÉng ch·ª•p ·∫£nh"], c: 1},
        {q: "Truy v·∫øt ngu·ªìn l·ªói l√† b∆∞·ªõc ki·ªÉm tra l·∫°i y·∫øu t·ªë n√†o sau ƒë√¢y?", a: ["M√£ ngu·ªìn ph·∫ßn m·ªÅm", "D·ªØ li·ªáu hu·∫•n luy·ªán", "H·ªá ƒëi·ªÅu h√†nh", "Webcam"], c: 1},
        {q: "·∫¢nh c√≥ b√†n tay che m·∫∑t ho·∫∑c v·∫≠t g√¢y nhi·ªÖu vi ph·∫°m ti√™u chu·∫©n n√†o?", a: ["ƒê√∫ng (Accuracy)", "ƒê·ªß", "ƒêa d·∫°ng", "ƒê·ªôc"], c: 0},
        {q: "N·∫øu d·ªØ li·ªáu ƒë√£ chu·∫©n 3ƒê m√† m√°y v·∫´n sai, ti·∫øt sau ch√∫ng ta s·∫Ω ch·ªânh y·∫øu t·ªë g√¨?", a: ["Mua m√°y m·ªõi", "X√≥a h·∫øt ·∫£nh", "Thi·∫øt l·∫≠p ƒë√†o t·∫°o (Epochs/Batch)", "Ngh·ªâ h·ªçc"], c: 2}
    ];

    let cur = 0, score = 0, canChoose = true;
    let pName = "", pClass = "";

    function checkLogin() {
        pName = document.getElementById('p-name').value;
        pClass = document.getElementById('p-class').value;
        if(pName && pClass) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('play-screen').style.display = 'block';
            loadQ();
        } else { alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t√™n v√† l·ªõp!"); }
    }

    function loadQ() {
        canChoose = true;
        document.getElementById('next-btn').style.display = 'none';
        document.getElementById('ai-icon').classList.remove('glitch');
        let q = db[cur];
        document.getElementById('q-text').innerText = (cur+1) + ". " + q.q;
        document.getElementById('progress').style.width = (cur/db.length)*100 + "%";
        let grid = document.getElementById('ans-grid');
        grid.innerHTML = '';
        q.a.forEach((txt, i) => {
            let b = document.createElement('button'); b.className = 'btn'; b.innerText = txt;
            b.onclick = () => {
                if(!canChoose) return;
                canChoose = false;
                if(i === q.c) { b.style.background = "var(--success)"; score += 20; confetti(); }
                else { b.style.background = "var(--danger)"; document.getElementById('ai-icon').classList.add('glitch'); score -= 5; }
                document.getElementById('points').innerText = score;
                document.getElementById('next-btn').style.display = 'block';
            };
            grid.appendChild(b);
        });
    }

    function nextStep() {
        cur++;
        if(cur < db.length) loadQ();
        else finishGame();
    }

    function finishGame() {
        document.getElementById('play-screen').style.display = 'none';
        document.getElementById('final-screen').style.display = 'block';
        document.getElementById('final-score').innerText = score + " ƒêI·ªÇM";
        document.getElementById('final-desc').innerText = "Ch√∫c m·ª´ng " + pName + " (" + pClass + ")!";
        
        // T·ª∞ ƒê·ªòNG G·ª¨I D·ªÆ LI·ªÜU V·ªÄ GOOGLE FORM
        let url = `${CONFIG_FORM.formAction}?${CONFIG_FORM.entryName}=${encodeURIComponent(pName)}&${CONFIG_FORM.entryClass}=${encodeURIComponent(pClass)}&${CONFIG_FORM.entryScore}=${score}&submit=Submit`;
        
        fetch(url, { mode: 'no-cors' })
            .then(() => { document.getElementById('save-status').innerText = "‚úÖ K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c l∆∞u!"; })
            .catch(() => { document.getElementById('save-status').innerText = "‚ùå L·ªói l∆∞u d·ªØ li·ªáu. H√£y b√°o GV!"; });
    }
</script>
</body>
</html>
